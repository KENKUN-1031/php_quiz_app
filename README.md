# クイズ作成と出題アプリケーション

このアプリケーションは、PHPとSQLiteを使用したクイズの作成・管理・出題システムです。

## 機能

1. **クイズ新規作成**: 問題と答えをデータベースに保存
2. **クイズ出題**: ランダムに問題を表示し、解答を判定
3. **クイズ編集**: 既存の問題を修正・削除

## セットアップ

### 必要な環境
- PHP 7.4以上
- SQLite3拡張が有効になっていること（またはMySQL）

### インストール手順

1. プロジェクトファイルをWebサーバーのドキュメントルートに配置

2. データベースの設定（`db.php`ファイルで設定）
   - デフォルトはSQLiteを使用
   - MySQLを使用する場合は、`DB_TYPE`を`'mysql'`に変更し、接続情報を設定

3. MySQLを使用する場合のみ、データベースをセットアップ:
   ```bash
   mysql -u root -p < setup.sql
   ```

4. Webブラウザでアクセス:
   ```
   http://localhost/quiz_app/
   ```

## ファイル構成

- `index.php` - トップページ
- `create.php` - クイズ新規作成画面
- `quiz.php` - クイズ出題画面
- `edit.php` - クイズ編集画面
- `db.php` - データベース接続設定
- `setup.sql` - MySQL用データベースセットアップファイル
- `setup_sqlite.sql` - SQLite用データベースセットアップファイル（参考）

## セキュリティ対策

### XSS（クロスサイトスクリプティング）対策
- 全ての出力に`htmlspecialchars()`関数を使用してHTMLエスケープを実施
- `h()`関数でラップして一元管理

### SQLインジェクション対策
- 全てのSQL文でプリペアードステートメントを使用
- バインドパラメータで値を安全に渡す

## 使用方法

### 1. クイズの新規作成
1. トップページから「新規作成」をクリック
2. 問題と答えを入力
3. 「保存」ボタンをクリック

### 2. クイズの出題
1. トップページから「出題」をクリック
2. ランダムに表示された問題に答えを入力
3. 「解答」ボタンをクリックして正誤判定
4. 「次の問題」ボタンで別の問題を表示

### 3. クイズの編集
1. トップページから「編集」をクリック
2. 編集したい問題の番号を入力し「読込」をクリック
3. 内容を修正して「修正」ボタン、または「削除」ボタンをクリック

## データベーステーブル構造

```sql
CREATE TABLE questions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    question VARCHAR(256) NOT NULL,
    answer VARCHAR(256) NOT NULL
);
```

## バリデーション

- 新規作成画面: 問題と答えは入力必須
- 編集画面: 番号は入力必須、修正時は問題と答えも必須
- 全ての入力値はトリム処理（前後の空白削除）を実施

## 動作確認

仕様書に記載されている動作確認用チェックシートに従って、正常系・異常系の動作を確認してください。

### テスト用SQLインジェクション文字列
テーブル名: `questions`

例: `0;DELETE FROM questions`

このような文字列を入力しても、プリペアードステートメントによって文字列として扱われ、SQL文として実行されません。
